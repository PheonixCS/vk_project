# Документация по боту

## Бизнес логика

Ограничение на постинг:
- Пост в группе не будет выпущен, если последний пост выпущен из того же донора. Отключается настройкой donors_alternation в каждой группе.
Глобально это правило может отключаться настройкой IGNORE_DONORS_REPEAT
- Обычный пост может быть выпущен только по расписанию. Исключением является мешающий рекламный пост:
если во время минуты постинга есть реклама, этот пост должен быть выпущен после 1 часа и 5 минут от времени постинга
рекламы

### Модерация

#### Удаление комментариев

Причины для удаления комментариев:
- Есть слова из списка бан-слов (is_stop_words_in_text)
- В одном слове слова из разных алфавитов (например, шкоlolo) (is_scam_words_in_text)
- Есть видео в комментарии (is_video_in_attachments)
- Есть ссылка в приложении (is_link_in_attachments)
- Комментарий от группы (is_group)
- Есть ссылки в тексте (is_links_in_text)
- Есть vk-ссылки в тексте (is_vk_links_in_text)
- Одновреммено аудио и фото в комментарии (is_audio_and_photo_in_attachments)

Причины для бана комментирующих:
- Комментарий от группы (is_audio_and_photo_in_attachments)
- Одновреммено аудио и фото в комментарии (is_audio_and_photo_in_attachments)
- Больше одного комментария с одинаковым текстом за сутки
- Больше одного комментария с одинаковыми вложениями за сутки

## Технические штуки

### Скрапинг

#### Периодические задачи

`delete_oldest.py` - удаляет старые записи донора в 8:15 по мск, если их количество превышает COMMON_RECORDS_COUNT_FOR_DONOR (80)